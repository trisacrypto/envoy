{{- $canEditTransfers := not .IsViewOnly -}}
{{- if $canEditTransfers }}
{{- with .TransactionDetail }}

{{- if and .Status.Review (not .Archived) }}
   {{ .CounterpartyID }}
{{- else }}
<!-- Transfer is archived or not in reviewable state -->
<section>
  <div class="card mt-6 text-bg-warning">
    <div class="card-header">
      <h3 class="card-title">Cannot Accept Transfer</h3>
    </div>
    <div class="card-body">
      <p class="lead">
        <i class="fe fe-alert-triangle"></i>
        {{ if .Archived}}
        This transfer has been archived and cannot be accepted.
        {{- else }}
        This transfer is in the <strong>{{ .Status }}</strong> state, which means that
        it cannot be reviewed/accepted and is awaiting some other action.
        {{- end }}
      </p>
      <p class="lead">
        Please return to the <a href="/transactions/{{ .ID }}">Transfer Detail</a> page.
      </p>
    </div>
  </div>
</section>
{{- end }}
{{- end }}

{{- else }}
<!-- User does not have permission to accept the transfer -->
<section>
  <div class="card mt-6 text-bg-warning">
    <div class="card-header">
      <h3 class="card-title">Insufficient Permissions</h3>
    </div>
    <div class="card-body">
      <p class="lead">
        <i class="fe fe-alert-triangle"></i>
        You do not have the permissions required to accept a travel rule transfer.
        Please return to the <a href="/transactions">Transfer Inbox</a> and contact
        your Envoy administrator if you require additional permissions.
      </p>
    </div>
  </div>
</section>
{{- end }}